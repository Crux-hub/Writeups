![](assets/Pasted%20image%2020231002165802.png)
# Summary
#### Findings:
* MS10-059
	* The host is running Windows Server 2008, which is no longer supported by Microsoft. Unsupported operating systems are often vulnerable to kernel exploits, since they are no longer receiving security updates.
* Drupal 7
	* Drupal 7 is outdated and vulnerable to several exploits, including remote code execution.
#### Recommendations:
* MS10-059
	* Upgrade to an operating system that is currently supported and receiving updates, such as Windows Server 2019 or Windows Server 2022.
* Drupal 7
	* Update to the latest version of Drupal. Drupal core 10.1.4 currently the latest version, released sep 20 2023.
# Attack Narrative
### Enumeration
* An Nmap scan was run on the provided IP address.  
![](assets/Pasted%20image%2020231002165131.png)
* The nmap scan shows that Drupal version 7 is being run on port 80.  
### Exploited vulnerabilities
* Drupal 7 is vulnerable to remote code execution. The tester used script found at https://github.com/slowmistio/CVE-2018-7601-Exploit-for-Drupal-7/blob/master/drupa7-CVE-2018-7600.py. The command executed was generated by metasploits web_delivery module to get a meterpreter shell as shown below.  
![](assets/Pasted%20image%2020231002153159.png)
* A shell was generated with the user iusr.  
![](assets/Pasted%20image%2020231002153128.png)
* Checking systeminfo shows that the host is running Windows Server 2008 r2.  
![](assets/Pasted%20image%2020231002164638.png)
* Windows Server 2008 can be vulnerable to MS10-059. The tester uploaded the exploit found at https://github.com/SecWiki/windows-kernel-exploits/blob/master/MS10-059/MS10-059.exe. Next a necat listener was setup on port 1234 and the exploit was executed.  
![](assets/Pasted%20image%2020231002164131.png)
![](assets/Pasted%20image%2020231002163939.png)
* The tester received a shell with system privileges.